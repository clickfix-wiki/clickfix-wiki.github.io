<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClickFix Wiki - Code execution by social engineering instructions</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .search-section {
            background: white;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .search-box {
            width: 100%;
            padding: 1rem;
            font-size: 1.1rem;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.3s;
        }

        .search-box:focus {
            border-color: #667eea;
        }

        .tools-list {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin: 2rem 0;
            overflow: hidden;
        }

        .tool-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid #f1f3f4;
            text-decoration: none;
            color: inherit;
            transition: background-color 0.2s;
        }

        .tool-item:last-child {
            border-bottom: none;
        }

        .tool-item:hover {
            background-color: #f8f9fa;
        }

        .tool-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            flex: 1;
            margin-right: 1rem;
        }

        .tool-meta {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .category {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-top: 0.5rem;
            background: #e9ecef;
            color: #495057;
        }

        .no-results {
            text-align: center;
            padding: 3rem;
            color: #666;
            font-size: 1.1rem;
        }

        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .stats {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stats span {
            font-weight: 600;
            color: #667eea;
        }

        .filter-section {
            background: white;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .filter-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        .filter-groups {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-start;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: #666;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
        }

        .filter-tag {
            padding: 0.15rem 0.5rem;
            background: #f8f9fa;
            border: 1px solid #e1e5e9;
            border-radius: 12px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s;
            user-select: none;
            line-height: 1.2;
        }

        .filter-tag:hover {
            background: #e9ecef;
        }

        .filter-tag.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .filter-tag.selected {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .clear-filters {
            background: #dc3545;
            color: white;
            border: none;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.7rem;
            margin-top: 0.5rem;
        }

        .clear-filters:hover {
            background: #c82333;
        }

        .tool-tags {
            margin-top: 0.5rem;
        }

        .tool-tag {
            display: inline-block;
            padding: 0.1rem 0.4rem;
            background: #e9ecef;
            border-radius: 8px;
            font-size: 0.6rem;
            margin: 0.05rem;
            color: #495057;
            line-height: 1.2;
        }

        .tools-list .tool-tag {
            font-size: 0.65rem;
            padding: 0.15rem 0.5rem;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>ClickFix Wiki</h1>
            <p>Code execution by social engineering instructions</p>
        </div>
    </div>

    <div class="container">
        <div class="search-section">
            <input type="text" class="search-box" id="searchBox" placeholder="Search tools, descriptions, or techniques...">
        </div>

        <div class="filter-section">
            <div class="filter-title">Filter by Tags</div>
            
            <div class="filter-groups">
                <div class="filter-group">
                    <div class="filter-group-title">Operating System</div>
                    <div class="filter-tags" id="osTags">
                        <!-- OS tags will be populated here -->
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-group-title">Interface Type</div>
                    <div class="filter-tags" id="interfaceTags">
                        <!-- Interface tags will be populated here -->
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-group-title">Function</div>
                    <div class="filter-tags" id="functionTags">
                        <!-- Function tags will be populated here -->
                    </div>
                </div>
            </div>

            <button class="clear-filters" id="clearFilters">Clear All Filters</button>
        </div>

        <div class="stats">
            <span id="totalTools">0</span> tools documented â€¢ 
            <span id="visibleTools">0</span> currently visible
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Loading tools...</p>
        </div>

        <div class="tools-list" id="toolsGrid">
            <!-- Tools will be loaded here -->
        </div>

        <div class="no-results" id="noResults" style="display: none;">
            <h3>No tools found</h3>
            <p>Try adjusting your search terms</p>
        </div>
    </div>

    <div class="footer">
        <div class="container">
            <p>Documenting Windows system tools for educational and legitimate system administration purposes</p>
        </div>
    </div>

    <script>
        // Parse YAML content
        function parseYAML(yamlText) {
            const lines = yamlText.split('\n');
            const result = {};
            let currentTechnique = null;
            let currentTechniqueKey = null;
            let inTechniques = false;

            for (let i = 0; i < lines.length; i++) {
                const line = lines[i];
                const trimmedLine = line.trim();
                if (!trimmedLine || trimmedLine.startsWith('#')) continue;

                // Get indentation level
                const indentLevel = line.length - line.trimStart().length;

                // Handle key-value pairs
                if (trimmedLine.includes(':') && !trimmedLine.startsWith('-')) {
                    const colonIndex = trimmedLine.indexOf(':');
                    const key = trimmedLine.substring(0, colonIndex).trim();
                    const value = trimmedLine.substring(colonIndex + 1).trim();
                    
                    if (value === '') {
                        // Empty value - initialize array
                        result[key] = [];
                        if (key === 'Techniques') {
                            inTechniques = true;
                        }
                    } else {
                        // Has value
                        if (value.startsWith('[') && value.endsWith(']')) {
                            // Array format like Tags: ["Windows", "CLI"]
                            const arrayContent = value.substring(1, value.length - 1);
                            result[key] = arrayContent.split(',').map(item => 
                                item.trim().replace(/"/g, '')
                            ).filter(item => item.length > 0);
                        } else {
                            result[key] = value.replace(/"/g, '');
                        }
                    }
                } else if (trimmedLine.startsWith('-')) {
                    // Array item
                    const item = trimmedLine.substring(1).trim();
                    
                    if (inTechniques && indentLevel === 2) {
                        // Start of a new technique
                        currentTechnique = {};
                        result.Techniques.push(currentTechnique);
                        currentTechniqueKey = null;
                        
                        // Parse the technique name if it's on the same line
                        if (item.includes('Name:')) {
                            const colonIndex = item.indexOf(':');
                            const value = item.substring(colonIndex + 1).trim();
                            currentTechnique.Name = value.replace(/"/g, '');
                        }
                        
                        // Look ahead for technique properties
                        let j = i + 1;
                        while (j < lines.length) {
                            const nextLine = lines[j];
                            const nextTrimmed = nextLine.trim();
                            const nextIndent = nextLine.length - nextLine.trimStart().length;
                            
                            if (nextIndent === 0) {
                                // Back to root level
                                break;
                            } else if (nextIndent === 2 && nextTrimmed.startsWith('-')) {
                                // Next technique starts
                                break;
                            } else if (nextIndent === 4 && nextTrimmed.includes(':')) {
                                // Technique property
                                const colonIndex = nextTrimmed.indexOf(':');
                                const key = nextTrimmed.substring(0, colonIndex).trim();
                                const value = nextTrimmed.substring(colonIndex + 1).trim();
                                currentTechnique[key] = value.replace(/"/g, '');
                                currentTechniqueKey = key;
                                
                                if (key === 'Steps' || key === 'References') {
                                    // Initialize array
                                    currentTechnique[key] = [];
                                }
                            } else if (nextIndent === 6 && nextTrimmed.startsWith('-')) {
                                // Array item for Steps or References
                                const arrayItem = nextTrimmed.substring(1).trim();
                                if (currentTechniqueKey === 'Steps') {
                                    currentTechnique.Steps.push(arrayItem.replace(/"/g, ''));
                                } else if (currentTechniqueKey === 'References') {
                                    currentTechnique.References.push(arrayItem.replace(/"/g, ''));
                                }
                            }
                            j++;
                        }
                    }
                }
            }

            return result;
        }

        // Tag categories for tools
        const tagCategories = {
            os: ['Windows', 'Linux', 'macOS'],
            interface: ['CLI', 'GUI'],
            function: ['Command Line', 'Scripting', 'System Tools', 'Registry', 'System Configuration', 'Networking', 'Security', 'File Management', 'Process Management', 'Network Tools', 'Security Tools', 'Development Tools']
        };

        // Selected filters
        let selectedFilters = {
            os: [],
            interface: [],
            function: []
        };

        // Load tools from YAML files dynamically
        async function loadTools() {
            const tools = [];

            try {
                // Try to load the index file first
                let toolFiles = [];
                
                try {
                    const indexResponse = await fetch('techniques/index.txt');
                    if (indexResponse.ok) {
                        const indexText = await indexResponse.text();
                        toolFiles = indexText.trim().split('\n').map(filename => 
                            `techniques/${filename.trim()}`
                        ).filter(filename => filename.endsWith('.yaml'));
                        console.log(`Loaded ${toolFiles.length} files from index.txt`);
                    }
                } catch (indexError) {
                    console.warn('Could not load index.txt:', indexError);
                }
                
                // If we couldn't load the index, use a fallback approach
                if (toolFiles.length === 0) {
                    console.log('No index file found, using fallback approach');
                    // Try common YAML files that might exist
                    const commonFiles = [
                        'techniques/cmd.yaml',
                        'techniques/powershell.yaml',
                        'techniques/regedit.yaml'
                    ];
                    
                    // Test which files exist by trying to fetch them
                    for (const file of commonFiles) {
                        try {
                            const testResponse = await fetch(file, { method: 'HEAD' });
                            if (testResponse.ok) {
                                toolFiles.push(file);
                            }
                        } catch (e) {
                            // File doesn't exist or can't be accessed
                        }
                    }
                }
                
                console.log(`Found ${toolFiles.length} YAML files to load`);
                
                // Load all found YAML files
                for (const file of toolFiles) {
                    try {
                        const response = await fetch(file, {
                            method: 'GET',
                            mode: 'cors',
                            headers: {
                                'Accept': 'text/plain'
                            }
                        });
                        
                        if (response.ok) {
                            const yamlText = await response.text();
                            const tool = parseYAML(yamlText);
                            // Add the ID from the filename
                            tool.id = file.replace('techniques/', '').replace('.yaml', '');
                            tools.push(tool);
                            console.log(`Successfully loaded ${file}`);
                        } else {
                            console.warn(`Failed to load ${file}: ${response.status} ${response.statusText}`);
                        }
                    } catch (fileError) {
                        console.warn(`Error loading ${file}:`, fileError);
                    }
                }
                
                return tools;
            } catch (error) {
                console.error('Error loading tools:', error);
                return [];
            }
        }

        // Populate filter tags
        function populateFilterTags() {
            // OS tags
            const osTagsContainer = document.getElementById('osTags');
            tagCategories.os.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'filter-tag';
                tagElement.textContent = tag;
                tagElement.onclick = () => toggleFilter('os', tag, tagElement);
                osTagsContainer.appendChild(tagElement);
            });

            // Interface tags
            const interfaceTagsContainer = document.getElementById('interfaceTags');
            tagCategories.interface.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'filter-tag';
                tagElement.textContent = tag;
                tagElement.onclick = () => toggleFilter('interface', tag, tagElement);
                interfaceTagsContainer.appendChild(tagElement);
            });

            // Function tags
            const functionTagsContainer = document.getElementById('functionTags');
            tagCategories.function.forEach(tag => {
                const tagElement = document.createElement('div');
                tagElement.className = 'filter-tag';
                tagElement.textContent = tag;
                tagElement.onclick = () => toggleFilter('function', tag, tagElement);
                functionTagsContainer.appendChild(tagElement);
            });
        }

        // Toggle filter selection
        function toggleFilter(category, tag, element) {
            const index = selectedFilters[category].indexOf(tag);
            if (index > -1) {
                selectedFilters[category].splice(index, 1);
                element.classList.remove('selected');
            } else {
                selectedFilters[category].push(tag);
                element.classList.add('selected');
            }
            applyFilters();
        }

        // Apply all filters
        function applyFilters() {
            const searchTerm = document.getElementById('searchBox').value;
            filterTools(searchTerm);
        }

        // Clear all filters
        function clearAllFilters() {
            selectedFilters = {
                os: [],
                interface: [],
                function: []
            };
            
            // Remove selected class from all filter tags
            document.querySelectorAll('.filter-tag').forEach(tag => {
                tag.classList.remove('selected');
            });
            
            applyFilters();
        }

        // Render tools
        function renderTools(toolsToRender) {
            const grid = document.getElementById('toolsGrid');
            const noResults = document.getElementById('noResults');
            const loading = document.getElementById('loading');
            
            loading.style.display = 'none';
            
            if (toolsToRender.length === 0) {
                grid.innerHTML = '';
                noResults.style.display = 'block';
            } else {
                noResults.style.display = 'none';
                grid.innerHTML = toolsToRender.map(tool => `
                    <a href="pages/${tool.id}.html" class="tool-item" data-id="${tool.id}">
                        <div class="tool-title">${tool.Name}</div>
                        <div class="tool-meta">
                            <span class="category">${tool.Category}</span>
                            ${tool.Tags ? tool.Tags.map(tag => `<span class="tool-tag">${tag}</span>`).join('') : ''}
                        </div>
                    </a>
                `).join('');
            }

            // Update stats
            document.getElementById('totalTools').textContent = window.allTools ? window.allTools.length : 0;
            document.getElementById('visibleTools').textContent = toolsToRender.length;
        }

        // Search and filter functionality
        function filterTools(searchTerm) {
            if (!window.allTools) return;
            
            let filtered = window.allTools;

            // Apply search filter
            if (searchTerm) {
                const searchLower = searchTerm.toLowerCase();
                filtered = filtered.filter(tool => (
                    tool.Name.toLowerCase().includes(searchLower) ||
                    tool.Description.toLowerCase().includes(searchLower) ||
                    (tool.Techniques && tool.Techniques.some(technique => 
                        technique.Name.toLowerCase().includes(searchLower) ||
                        technique.Description.toLowerCase().includes(searchLower)
                    ))
                ));
            }

            // Apply tag filters
            const allSelectedTags = [
                ...selectedFilters.os,
                ...selectedFilters.interface,
                ...selectedFilters.function
            ];

            if (allSelectedTags.length > 0) {
                filtered = filtered.filter(tool => {
                    if (!tool.Tags) return false;
                    return allSelectedTags.every(selectedTag => 
                        tool.Tags.includes(selectedTag)
                    );
                });
            }

            renderTools(filtered);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            const tools = await loadTools();
            window.allTools = tools;
            
            // Populate filter tags
            populateFilterTags();
            
            // Set up clear filters button
            document.getElementById('clearFilters').addEventListener('click', clearAllFilters);
            
            renderTools(tools);

            // Search functionality
            const searchBox = document.getElementById('searchBox');
            searchBox.addEventListener('input', (e) => {
                filterTools(e.target.value);
            });
        });
    </script>
</body>
</html> 